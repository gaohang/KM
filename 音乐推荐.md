# 核心

## 冷启动

### PlaylistColdStart



## 向量



# 工程

## hbase

## redis

## hive

# 标签体系

## 步骤

- 标签生成

  对歌单标题进行关键词提取+人工添加
  相似关键词合并 -> 48个基础标签

- 歌单打标

  用 基础标签 对 歌单打标

- 标签传播

  歌单标签 -> 歌曲、用户、专辑 标签

# 歌单推荐

### 画像

#### 用户画像

##### 基础信息

​	age，city，

##### 统计信息

​	<用户，歌单>行为次数和比率

​	长中短期用户行为次数和率

#### 歌单画像

##### 基础信息

​	曲目数：num,free,vip

##### 统计信息

​	长中短期<用户，歌单>次数和率

### 召回

- 术语：seed，阿里称之为trigger，i.e.召回使用的方法，凭什么召回。例如，seed为播放过的歌单，就是以用户歌单播放行为召回。

#### 行为召回

- ​	<user, seed 歌单> left join <歌单， 相似歌单列表> => explode 一行变多行 =>  <user, 歌单>
- ​	注：seed 歌单=topK（播放，收藏，分享，搜索）歌单，	行为类别：<用户,歌单>行为，<用户,歌曲>行为

#### 向量召回

#### 场景召回

- 离线节假日召回：以weekday为seed，<user, weekday> left join <weekday，topK歌单>
- 时间地点召回类似上面



#### 标签召回

```scala
object TagPreference {
```



### 排序

​	

#### xgb

##### 缺点

- 难挖掘<user,item>交叉特征。虽然在recall时使用了用户行为seed召回，但召回的item若较为冷门，则会被xgb打低分。因此还是要DNN。

##### train

```
正样本：playlistPlayHistory
负样本：trainDataXgbNeg  采样后，正:负=1:3
val trainDataXgb = trainDataXgbPos.union(trainDataXgbNeg)
```

##### pred

<user, item> 数量达百亿，需要利用hash分桶 分批打分。

#### DNN



### 人工规则

模型打分偏向热门歌曲，因此需要人工规则给一些冷门歌单提高分数。

